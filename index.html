<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARC Bubble USDC Arcade</title>
    <style>
        body {
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: #0a0a0a url('background.png') no-repeat center center fixed;
            background-size: cover;
            font-family: 'Segoe UI', Arial, sans-serif;
            color: white;
            overflow: hidden;
        }

        #game-container {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 20px;
            text-align: center;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        canvas {
            background: rgba(0, 0, 0, 0.1);
            border: 2px solid #00BFFF;
            border-radius: 12px;
            cursor: crosshair;
        }

        .controls {
            margin-top: 10px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        button {
            background: #00ff88;
            color: black;
            border: none;
            padding: 10px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.2s;
        }

        button:hover { transform: scale(1.02); filter: brightness(1.1); }
        .btn-deposit { background: #2775ca; color: white; } /* Cor USDC */

        #hud {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
            background: rgba(0,0,0,0.6);
            padding: 10px;
            border-radius: 10px;
        }
    </style>
</head>
<body>

<div id="game-container">
    <h2 style="margin: 0 0 10px 0;">USDC BUBBLE ARCADE</h2>
    
    <div id="hud">
        <div>üí∞ SALDO: <span id="usdc-balance">0.000</span> USDC</div>
        <div>üè¶ POOL: <span id="pool-total">0.00</span> USDC</div>
    </div>

    <div id="wallet-info" style="font-size: 11px; margin-bottom: 10px; color: #00ff88;">DESCONECTADO</div>

    <canvas id="gameCanvas" width="450" height="500"></canvas>

    <div class="controls">
        <button id="connect-btn">CONECTAR CARTEIRA</button>
        <button class="btn-deposit" onclick="depositPool()">DEPOSITAR NA POOL</button>
        <button style="background: #ff4444; color: white;" onclick="resetGame()">REINICIAR</button>
        <button style="background: #ffca28;" onclick="skipLevel()">PULAR FASE</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const USDC_ADDRESS = "0x3600000000000000000000000000000000000000";

    // --- CONFIGURA√á√ÉO RECOMPENSAS ---
    const rewardMap = {'#00BFFF': 0.001, '#FF1493': 0.002, '#32CD32': 0.003, '#FFD700': 0.004};
    const colors = ['#00BFFF', '#FF1493', '#32CD32', '#FFD700'];
    const names = {'#00BFFF': 'blue', '#FF1493': 'pink', '#32CD32': 'green', '#FFD700': 'yellow'};
    
    let totalEarned = 0, level = 1, bubbles = [], floatingTexts = [];
    let bullet = { x: 225, y: 460, r: 40, active: false, dx: 0, dy: 0 };

    // --- IMAGENS ---
    const imgs = {};
    colors.forEach(c => { imgs[c] = new Image(); imgs[c].src = names[c] + '.png'; });
    const shootImg = new Image(); shootImg.src = 'shooter.png';

    // --- WEB3 LOGIC ---
    let provider, signer, walletAddress;

    document.getElementById('connect-btn').onclick = async () => {
        if (window.ethereum) {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            walletAddress = await signer.getAddress();
            document.getElementById('wallet-info').innerText = "CONECTADO: " + walletAddress;
            document.getElementById('connect-btn').style.display = "none";
        }
    };

    async function depositPool() {
        const amount = prompt("Quanto USDC deseja depositar na Pool?");
        if (amount && signer) {
            alert(`Iniciando dep√≥sito de ${amount} USDC para o contrato ${USDC_ADDRESS}`);
            // Aqui entraria a chamada de contrato: contract.transfer(pool_address, amount)
        }
    }

    function init(lvl) {
        bubbles = [];
        bullet.active = false; bullet.x = 225; bullet.y = 460;
        const rows = 4 + lvl; 
        for (let i = 0; i < rows; i++) {
            let col = colors[i % colors.length];
            for (let j = 0; j < 16; j++) { 
                bubbles.push({ x: 35 + (j * 25), y: 60 + (i * 25), r: 10, color: col, active: true });
            }
        }
    }

    canvas.addEventListener('mousedown', (e) => {
        if