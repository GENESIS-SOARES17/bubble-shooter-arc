<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>USDC TERMINAL PRO 2026</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#00ff88;
  --secondary:#2775ca;
  --gold:#ffca28;
  --danger:#ff4444;
  --bg:#050505;
}
*{box-sizing:border-box}
body{
  margin:0;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  background:radial-gradient(circle at top,#0b1a14,#000);
  font-family:Segoe UI,sans-serif;
  color:#fff;
}
#app{
  width:min(920px,95vw);
  background:rgba(15,15,15,.85);
  border-radius:26px;
  padding:18px;
  border:1px solid rgba(0,255,136,.25);
  backdrop-filter:blur(14px);
  box-shadow:0 0 50px rgba(0,0,0,.9);
}
#ticker{
  background:rgba(0,0,0,.7);
  border:1px solid #333;
  border-radius:14px;
  padding:10px;
  overflow:hidden;
  margin-bottom:12px;
}
#ticker span{
  display:inline-block;
  padding-right:40px;
  font-size:13px;
  font-weight:bold;
  color:var(--primary);
  animation:scroll 28s linear infinite;
  white-space:nowrap;
}
@keyframes scroll{
  0%{transform:translateX(100%)}
  100%{transform:translateX(-100%)}
}
.hud{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-bottom:10px;
}
.card{
  background:rgba(0,0,0,.6);
  border:1px solid #444;
  border-radius:16px;
  padding:12px;
  text-align:center;
}
.card small{opacity:.6;font-size:11px}
.card strong{font-size:26px;color:var(--primary)}
#gameBox{
  margin-top:10px;
  border-radius:20px;
  border:2px solid var(--secondary);
  overflow:hidden;
  position:relative;
}
canvas{
  display:block;
  width:100%;
  background:#000;
}
.float-text{
  position:absolute;
  font-size:14px;
  color:var(--gold);
  animation:float 1.2s ease-out forwards;
  pointer-events:none;
}
@keyframes float{
  from{opacity:1;transform:translateY(0)}
  to{opacity:0;transform:translateY(-40px)}
}
.buttons{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-top:12px;
}
button{
  border:none;
  border-radius:12px;
  padding:14px;
  font-weight:bold;
  cursor:pointer;
  transition:.2s;
}
button:hover{transform:scale(1.03)}
#connectBtn{
  grid-column:span 2;
  background:var(--primary);
  color:#000;
  font-size:17px;
}
#nextBtn{background:var(--secondary);color:#fff}
#withdrawBtn{background:var(--gold);color:#000}
.locked{
  opacity:.2;
  pointer-events:none;
  filter:blur(8px);
}
</style>
</head>
<body>

<div id="app">

  <div id="ticker">Carregando mercado...</div>

  <div class="hud">
    <div class="card">
      <small>GANHOS</small>
      <strong>$<span id="usdVal">0.000</span></strong>
      <div id="brlVal" style="color:var(--gold);font-size:13px">R$ 0,00</div>
    </div>
    <div class="card">
      <small>ENERGIA</small>
      <strong><span id="energyVal">3</span>/3</strong>
      <div id="timerVal" style="font-size:12px;color:var(--gold)">REGEN ATIVO</div>
    </div>
  </div>

  <div id="gameBox" class="locked">
    <canvas id="game"></canvas>
  </div>

  <div class="buttons">
    <button id="connectBtn">ðŸ”Œ CONECTAR CARTEIRA</button>
    <button id="withdrawBtn">ðŸ’° SACAR</button>
    <button id="nextBtn">ðŸš€ PRÃ“XIMA FASE (-1âš¡)</button>
  </div>

</div>

<script>
/* ===========================
   STATE
=========================== */
const State={
  wallet:null,
  balance:0,
  level:1,
  energy:{count:3,last:Date.now()},
  brl:5.5
};

/* ===========================
   UTILS
=========================== */
const $=id=>document.getElementById(id);

function save(){
  if(State.wallet){
    localStorage.setItem("usdc_"+State.wallet,JSON.stringify({
      balance:State.balance,
      energy:State.energy,
      level:State.level
    }));
  }
}
function load(){
  if(!State.wallet) return;
  const data=JSON.parse(localStorage.getItem("usdc_"+State.wallet));
  if(data){
    State.balance=data.balance||0;
    State.energy=data.energy||State.energy;
    State.level=data.level||1;
  }
}

/* ===========================
   UI
=========================== */
function updateUI(){
  $("usdVal").innerText=State.balance.toFixed(3);
  $("brlVal").innerText="R$ "+(State.balance*State.brl).toFixed(2);
  $("energyVal").innerText=State.energy.count;
}

function floatText(text,x,y){
  const div=document.createElement("div");
  div.className="float-text";
  div.innerText=text;
  div.style.left=x+"px";
  div.style.top=y+"px";
  $("gameBox").appendChild(div);
  setTimeout(()=>div.remove(),1200);
}

/* ===========================
   SOUND FX
=========================== */
const SFX={
  boom:new Audio("https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-explosion-2759.mp3"),
  shoot:new Audio("https://assets.mixkit.co/sfx/preview/mixkit-game-ball-tap-2073.mp3")
};
function playSound(name){
  try{
    SFX[name].currentTime=0;
    SFX[name].play();
  }catch(e){}
}

/* ===========================
   ENERGY SYSTEM
=========================== */
function energyLoop(){
  const now=Date.now();
  const REGEN=3*60*60*1000;
  const elapsed=now-State.energy.last;
  const regen=Math.floor(elapsed/REGEN);
  if(regen>0){
    State.energy.count=Math.min(3,State.energy.count+regen);
    State.energy.last+=regen*REGEN;
    save();
  }
  updateUI();
}
setInterval(energyLoop,1000);

/* ===========================
   MARKET DATA
=========================== */
async function market(){
  try{
    const res=await fetch("https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=8");
    const data=await res.json();
    $("ticker").innerHTML=data.map(c=>`
      <span>${c.symbol.toUpperCase()} $${c.current_price.toLocaleString()}
      <span style="color:${c.price_change_percentage_24h>=0?"#00ff88":"#ff4444"}">
      ${c.price_change_percentage_24h>=0?"â–²":"â–¼"}${c.price_change_percentage_24h.toFixed(2)}%</span></span>
    `).join("");
    const brl=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=usd-coin&vs_currencies=brl");
    const brlData=await brl.json();
    State.brl=brlData["usd-coin"].brl;
    updateUI();
  }catch(e){}
}
market();
setInterval(market,60000);

/* ===========================
   WEB3 CONNECT
=========================== */
$("connectBtn").onclick=async()=>{
  if(window.ethereum){
    const acc=await ethereum.request({method:"eth_requestAccounts"});
    State.wallet=acc[0];
    load();
    $("connectBtn").style.display="none";
    $("gameBox").classList.remove("locked");
    updateUI();
  }else{
    alert("MetaMask nÃ£o encontrada.");
  }
};

/* ===========================
   GAME ENGINE
=========================== */
const canvas=$("game");
const ctx=canvas.getContext("2d");

function resize(){
  canvas.width=Math.min(820,window.innerWidth-60);
  canvas.height=canvas.width*0.55;
}
resize();
window.onresize=resize;

const Game={
  bubbles:[],
  bullet:{x:0,y:0,r:15,dx:0,dy:0,active:false}, // +25%
  power:0,
  charging:false,

  init(){
    this.bubbles=[];
    const colors=["#00ff88","#2775ca","#ffca28","#ff4444"];

    const gapX=50;
    const gapY=45;
    const cols=Math.floor(canvas.width/gapX);
    const rows=Math.floor((canvas.height*0.65)/gapY);

    for(let i=0;i<rows;i++){
      for(let j=0;j<cols;j++){
        this.bubbles.push({
          x:gapX/2 + j*gapX,
          y:gapY/2 + i*gapY,
          r:18,
          color:colors[(i+j)%4],
          active:true
        });
      }
    }
    this.resetBullet();
  },

  resetBullet(){
    this.bullet.active=false;
    this.bullet.x=canvas.width/2;
    this.bullet.y=canvas.height-30;
    this.bullet.dx=0;
    this.bullet.dy=0;
  },

  shoot(angle){
    playSound("shoot");
    const basePower=14+State.level*0.8;
    const power=basePower+this.power;
    this.bullet.dx=Math.cos(angle)*power;
    this.bullet.dy=Math.sin(angle)*power;
    this.bullet.active=true;
    this.bullet.boost=1.4;
  },

  update(){
    if(this.charging && this.power<22){
      this.power+=0.4;
    }

    if(this.bullet.active){
      this.bullet.dx*=this.bullet.boost;
      this.bullet.dy*=this.bullet.boost;
      this.bullet.boost=1;

      this.bullet.dy+=0.06;
      this.bullet.x+=this.bullet.dx;
      this.bullet.y+=this.bullet.dy;

      if(this.bullet.x<0||this.bullet.x>canvas.width){
        this.bullet.dx*=-1.05;
      }

      this.bubbles.forEach(b=>{
        if(b.active && Math.hypot(this.bullet.x-b.x,this.bullet.y-b.y)<b.r+this.bullet.r){
          b.active=false;

          playSound("boom");
          for(let i=0;i<8;i++){
            floatText("ðŸ’¥",this.bullet.x+(Math.random()*30-15),this.bullet.y+(Math.random()*30-15));
          }

          const reward=(0.006/(1+State.level*0.15));
          State.balance+=reward;
          floatText("+"+reward.toFixed(3)+" USDC",this.bullet.x,this.bullet.y);
          save();
          this.resetBullet();
        }
      });

      if(this.bullet.y<0||this.bullet.y>canvas.height){
        this.resetBullet();
      }
    }
  },

  draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    this.bubbles.forEach(b=>{
      if(b.active){
        ctx.beginPath();
        ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
        ctx.fillStyle=b.color;
        ctx.fill();
      }
    });

    ctx.beginPath();
    ctx.arc(this.bullet.x,this.bullet.y,this.bullet.r,0,Math.PI*2);
    ctx.fillStyle="#fff";
    ctx.fill();
  }
};

/* ===========================
   CONTROLS
=========================== */
canvas.addEventListener("mousedown",()=>{
  if(Game.bullet.active) return;
  Game.charging=true;
  Game.power=0;
});

canvas.addEventListener("mouseup",(e)=>{
  if(Game.bullet.active) return;
  const rect=canvas.getBoundingClientRect();
  const angle=Math.atan2(e.clientY-rect.top-Game.bullet.y,e.clientX-rect.left-Game.bullet.x);
  Game.shoot(angle);
  Game.charging=false;
});

/* ===========================
   LOOP
=========================== */
function loop(){
  Game.update();
  Game.draw();
  requestAnimationFrame(loop);
}
Game.init();
loop();

/* ===========================
   BUTTONS
=========================== */
$("nextBtn").onclick=()=>{
  if(State.energy.count>0){
    State.energy.count--;
    State.energy.last=Date.now();
    State.level++;
    Game.init();
    save();
    updateUI();
  }else{
    alert("Energia insuficiente!");
  }
};

$("withdrawBtn").onclick=()=>{
  alert("Sistema de saque real deve ser conectado a smart contract.");
};
</script>
</body>
</html>