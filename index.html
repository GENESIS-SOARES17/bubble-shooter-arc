<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>USDC Arcade - Responsive Edition</title>
    <style>
        body {
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: #0a0a0a url('background.png') no-repeat center center fixed;
            background-size: cover;
            font-family: 'Segoe UI', Arial, sans-serif;
            color: white;
            overflow: hidden;
        }

        #game-container {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 90vw; /* Largura ajustável à tela */
            max-width: 500px;
        }

        .header-logos {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .logo-img { width: 50px; height: 50px; object-fit: contain; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }

        #hud {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            background: rgba(0,0,0,0.8);
            padding: 10px;
            border-radius: 12px;
            margin-bottom: 10px;
            font-size: 12px;
        }

        canvas {
            background: rgba(0, 0, 0, 0.1);
            border: 2px solid #00BFFF;
            border-radius: 12px;
            width: 100%; /* Canvas segue a largura do container */
            height: auto;
            cursor: crosshair;
        }

        .controls {
            margin-top: 10px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        button {
            border: none;
            padding: 10px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 11px;
        }

        #connect-btn { background: #00ff88; color: black; }
        #withdraw-btn { background: #ffca28; color: black; }
        #deposit-btn { background: #2775ca; color: white; }
        #reset-btn { background: #ff4444; color: white; }
    </style>
</head>
<body>

<div id="game-container">
    <div class="header-logos">
        <img src="logo_a.png" class="logo-img" alt="A">
        <h3 style="margin: 0;">USDC ARCADE</h3>
        <img src="logo_circle.png" class="logo-img" alt="Circle">
    </div>
    
    <div id="hud">
        <div>SALDO: <span id="usdc-balance" style="color: #00ff88;">0.000</span></div>
        <div>POOL: <span style="color: #2775ca;">245.80</span></div>
    </div>

    <canvas id="gameCanvas" width="400" height="450"></canvas>

    <div class="controls">
        <button id="connect-btn">CONECTAR</button>
        <button id="withdraw-btn">SACAR</button>
        <button id="deposit-btn">DEPOSITAR</button>
        <button id="reset-btn">REINICIAR</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const rewardMap = {'#00BFFF': 0.001, '#FF1493': 0.002, '#32CD32': 0.003, '#FFD700': 0.004};
    const colors = ['#00BFFF', '#FF1493', '#32CD32', '#FFD700'];
    const names = {'#00BFFF': 'blue', '#FF1493': 'pink', '#32CD32': 'green', '#FFD700': 'yellow'};
    
    let totalEarned = 0, bubbles = [], floatingTexts = [];
    // Shooter reduzido em 50% (raio 20)
    let bullet = { x: 200, y: 410, r: 20, active: false, dx: 0, dy: 0 }; 

    const imgs = {};
    colors.forEach(c => { imgs[c] = new Image(); imgs[c].src = names[c] + '.png'; });
    const shootImg = new Image(); shootImg.src = 'shooter.png';

    function init() {
        bubbles = [];
        bullet.active = false; bullet.x = 200; bullet.y = 410;
        // Ajuste automático das bolhas coloridas para o tamanho da tela
        const rows = 6;
        const cols = 10;
        const radius = 16;
        const spacing = 38;

        for (let i = 0; i < rows; i++) {
            let col = colors[i % colors.length];
            for (let j = 0; j < cols; j++) {
                bubbles.push({ x: 29 + (j * spacing), y: 50 + (i * spacing), r: radius, color: col, active: true });
            }
        }
    }

    canvas.addEventListener('mousedown', (e) => {
        if (bullet.active) return;
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;
        const mouseX = (e.clientX - rect.left) * scaleX;
        const mouseY = (e.clientY - rect.top) * scaleY;
        
        const angle = Math.atan2(mouseY - bullet.y, mouseX - bullet.x);
        bullet.dx = Math.cos(angle) * 10;
        bullet.dy = Math.sin(angle) * 10;
        bullet.active = true;
    });

    function update() {
        if (bullet.active) {
            bullet.x += bullet.dx; bullet.y += bullet.dy;
            if (bullet.x < bullet.r || bullet.x > canvas.width - bullet.r) bullet.dx *= -1;
            
            for (let b of bubbles) {
                if (b.active && Math.hypot(bullet.x - b.x, bullet.y - b.y) < bullet.r + b.r) {
                    b.active = false;
                    totalEarned += rewardMap[b.color];
                    document.getElementById('usdc-balance').innerText = totalEarned.toFixed(3);
                    floatingTexts.push({ x: b.x, y: b.y, text: `+$${rewardMap[b.color]}`, opacity: 1 });
                    
                    // MECÂNICA CORRIGIDA: A bolha para no primeiro impacto e reseta
                    bullet.active = false; 
                    bullet.x = 200; 
                    bullet.y = 410;
                    break; 
                }
            }
            if (bullet.y < 0 || bullet.y > 450) { bullet.active = false; bullet.x = 200; bullet.y = 410; }
        }
        floatingTexts.forEach((t, i) => { t.y -= 1; t.opacity -= 0.02; if (t.opacity <= 0) floatingTexts.splice(i, 1); });
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        bubbles.forEach(b => {
            if (b.active) {
                if (imgs[b.color].complete) ctx.drawImage(imgs[b.color], b.x-b.r, b.y-b.r, b.r*2, b.r*2);
                else { ctx.beginPath(); ctx.arc(b.x, b.y, b.r, 0, Math.PI*2); ctx.fillStyle = b.color; ctx.fill(); }
            }
        });
        floatingTexts.forEach(t => {
            ctx.fillStyle = `rgba(0, 255, 136, ${t.opacity})`;
            ctx.font = "bold 10px Arial";
            ctx.fillText(t.text, t.x - 10, t.y);
        });
        if (shootImg.complete) ctx.drawImage(shootImg, bullet.x-bullet.r, bullet.y-bullet.r, bullet.r*2, bullet.r*2);
        update();
        requestAnimationFrame(draw);
    }

    // Handlers corrigidos
    document.getElementById('connect-btn').onclick = () => alert("Conectando...");
    document.getElementById('withdraw-btn').onclick = () => alert("Sacando USDC...");
    document.getElementById('reset-btn').onclick = () => init();

    init();
    draw();
</script>
</body>
</html>